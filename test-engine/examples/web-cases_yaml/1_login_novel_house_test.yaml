desc: 读书屋登录测试 - 升级为 Playwright 新格式

pre_script:
  - 'print("开始执行登录测试...")'

steps:
  - 打开浏览器并访问登录页:
      关键字: open_browser
      browser: "{{BROWSER}}"
      headless: "{{HEADLESS}}"
      url: http://novel.hctestedu.com/user/login.html
  
  - 等待页面加载:
      关键字: wait_for_page_load
      wait_until: networkidle
      timeout: 30000

  - 等待用户名输入框可见:
      关键字: wait_for_element_visible
      locator_type: id
      element: txtUName
      timeout: 15000

  - 输入用户名:
      关键字: input_text
      locator_type: id
      element: txtUName
      text: '{{username}}'
      timeout: 10000
      wait_visible: true
  
  - 等待密码输入框可见:
      关键字: wait_for_element_visible
      locator_type: id
      element: txtPassword
      timeout: 10000

  - 输入密码:
      关键字: input_text
      locator_type: id
      element: txtPassword
      text: '{{password}}'
      timeout: 10000
      wait_visible: true
  
  - 等待输入完成:
      关键字: sleep
      time: 1
  
  - 点击登录按钮:
      关键字: click_element
      locator_type: name
      element: btnLogin
  
  - 等待登录处理:
      关键字: sleep
      time: 2
  
  # 数据库验证（可选）
  #- 查询数据库验证用户信息:
  #    关键字: mysql_sql_exec
  #    数据库: mysql001
  #    SQL: SELECT username,nick_name FROM `user` WHERE username = "{{username}}"
  #    引用变量:
  #      - "nick_name"
  #      - "username"
  
  # URL 断言（可选）
  #- 判断是否跳转到首页:
  #    关键字: assert_url_contains
  #    expected_text: novel.hctestedu.com
  
  - 断言页面标题:
      关键字: assert_title_equals
      expected_title: 读书屋_原创小说网站
  
  # 用户名验证（可选）
  #- 确认登录成功显示用户名:
  #    关键字: assert_element_text_equals
  #    locator_type: xpath
  #    element: //*[@id='headerUserInfo']/span/a[1]
  #    expected_text: "{{nick_name}}"
  
  - 登录成功截图:
      关键字: take_screenshot
      filename: login_success_{{username}}
  
  - 关闭浏览器:
      关键字: close_browser

post_script:
  - 'print("登录测试执行完成")'

# 数据驱动测试
ddts:
  - username: 13800138001
    password: '123456'
    desc: "正常登录场景 - 正确的用户名和密码"
  
  - username: 13800138002
    password: '123456'
    desc: "多账户测试 - 第二个测试账户"
