# 登录流程性能测试
# 模拟完整用户业务流程的性能表现

name: 用户登录流程压测
desc: 模拟用户登录、浏览、操作的完整业务流程

steps:
  # 事务开始 - 登录流程
  - 开始登录事务:
      关键字: start_transaction
      name: 用户登录

  # 访问首页
  - 访问首页:
      关键字: get
      url: /
      name: 首页

  # 页面加载等待
  - 页面加载:
      关键字: think_time
      seconds: 1

  # 提交登录
  - 提交登录:
      关键字: post
      url: /post
      name: 登录接口
      json:
        username: "{{username}}"
        password: "{{password}}"

  # 验证登录响应
  - 验证登录:
      关键字: check_status
      expected: 200

  # 事务结束
  - 结束登录事务:
      关键字: end_transaction
      success: true

  # 用户浏览间隔
  - 浏览间隔:
      关键字: think_time
      min: 2
      max: 5

  # 事务开始 - 数据获取
  - 开始数据事务:
      关键字: start_transaction
      name: 获取数据

  # 获取用户信息
  - 获取用户信息:
      关键字: get
      url: /headers
      name: 用户信息
      headers:
        Authorization: "Bearer token-123"

  # 获取数据列表
  - 获取数据列表:
      关键字: get
      url: /json
      name: 数据列表

  # 验证数据响应时间
  - 验证响应时间:
      关键字: check_response_time
      max_ms: 3000

  # 事务结束
  - 结束数据事务:
      关键字: end_transaction
      success: true

  # 记录日志
  - 记录完成:
      关键字: log
      message: "用户 {{username}} 完成一次完整流程"
