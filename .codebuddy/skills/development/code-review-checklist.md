# 代码复用检查 Skill

## 概述
本 Skill 用于在生成任何业务代码之前，强制检查是否已有相关的业务服务或功能，避免重复开发。适用于任何技术栈。

## 核心原则
**严格要求：在生成任何业务代码之前，必须主动查看现有代码和文档，全面确认是否已有相关的业务服务或功能。**

---

## 强制检查流程

### 第一步：查看功能清单文档
使用 read_file 工具查看完整的功能清单文档（如 func.md）

**检查范围**：
- Service 层
- Repository / DAO 层
- Model / Entity 层
- 工具类
- 组件层

### 第二步：逐层分析现有功能

#### 后端项目检查清单
```markdown
- [ ] Service层：查看是否已有类似的业务服务
- [ ] Repository层：查看是否已有相关的数据访问接口
- [ ] Model层：查看是否已有相关的数据模型
- [ ] Utils层：查看是否已有相关的工具函数
- [ ] Router层：查看是否已有相关的接口定义
```

#### 前端项目检查清单
```markdown
- [ ] API层：查看是否已有相关的接口封装
- [ ] 组件层：查看是否已有相关的组件
- [ ] Composables/Hooks：查看是否已有相关的组合式函数
- [ ] Store层：查看是否已有相关的状态管理
- [ ] Utils层：查看是否已有相关的工具函数
```

### 第三步：代码复用决策

| 优先级 | 场景 | 处理方式 |
|-------|------|---------|
| 1 | 发现完全匹配的功能 | 直接复用现有代码 |
| 2 | 发现类似功能 | 在现有类中扩展方法 |
| 3 | 发现相关但不完全匹配 | 评估是否可以重构复用 |
| 4 | 确认没有相关功能 | 创建新的类或服务 |

---

## 具体检查示例

### 用户相关功能开发
**必查项目**：
- 后端: UserService、AuthService、UserRepository
- 前端: UserApi、useUserStore、AuthApi

**检查内容**：
- 用户登录
- 用户注册
- 信息管理
- 密码管理

### 通用 CRUD 功能开发
**必查项目**：
- 后端: 对应模块的 Service、Repository
- 前端: 对应模块的 Api、Store

**检查内容**：
- 列表查询
- 详情查询
- 创建/更新
- 删除

---

## 违规检查机制

### 发现重复开发的处理
1. **立即停止**：一旦发现已有相关功能，立即停止新开发
2. **重新分析**：分析现有功能是否满足需求
3. **选择策略**：确定是复用、扩展还是重构
4. **重新实施**：基于选定策略重新实施

### 检查不充分的后果
- **代码冗余**：造成系统中存在重复功能
- **维护困难**：增加后续维护和 bug 修复的复杂度
- **性能问题**：重复的数据库查询和业务逻辑
- **团队效率下降**：浪费开发时间和资源

---

## 命名规范参考

### 后端项目
```
Service层：{业务域}Service
Repository层：{业务域}Repository
Model层：{业务域}Model / {业务域}Entity
Utils层：{功能}Utils / {功能}Helper
Router层：{业务域}Router / {业务域}Controller
```

### 前端项目
```
API层：{业务域}Api / {业务域}.api
组件层：{功能}Component / {功能}.vue / {功能}.tsx
Store层：use{业务域}Store
Utils层：{功能}Utils / {功能}.util
Hooks层：use{功能}
```

---

## 文档同步要求

- **每次新增服务**：必须同步更新功能清单文档
- **每次修改方法**：必须同步更新相关服务的功能描述
- **每次重构**：必须更新相关的文档说明

---

## 执行检查清单

在开始任何代码开发前，请确认：

```markdown
- [ ] 已查看完整的功能清单文档
- [ ] 已逐层检查各个层级的现有功能
- [ ] 已确认没有重复或类似的现有功能
- [ ] 已选择合适的复用或扩展策略
- [ ] 已准备在完成后更新功能清单文档
```

---

## 检查报告模板

```markdown
## 代码复用检查报告

### 检查时间
[DATETIME]

### 需求描述
[简要描述需要开发的功能]

### 检查结果

#### Service 层
- 已检查服务：[列出检查的服务]
- 发现相关功能：[是/否]
- 相关功能描述：[如有]

#### Repository 层
- 已检查仓库：[列出检查的仓库]
- 发现相关功能：[是/否]
- 相关功能描述：[如有]

#### 其他层
...

### 复用决策
- [ ] 直接复用现有代码
- [ ] 在现有类中扩展方法
- [ ] 重构后复用
- [ ] 创建新的服务

### 实施计划
[基于复用决策的具体实施计划]
```

---

**重要提醒：违反此检查流程将导致代码重复、系统冗余和维护困难，必须严格遵守！**
