desc: AI版-接口关联(登录并加入购物车)

# 使用AI关键字进行接口关联测试
# 与传统关键字版本(2_interface_association.yaml)对比，AI版本更智能地处理接口依赖

pre_script:
  - 'print("AI版接口关联测试开始...")'

steps:
  # 1. 配置 AI 助手
  - 配置AI助手:
      关键字: ai_configure
      llm_provider: siliconflow
      llm_model: deepseek-ai/DeepSeek-V3

  # 2. AI 发送登录请求
  - AI登录获取Token:
      关键字: ai_send_request
      task: "发送登录请求，用户名hami，密码123456"
      base_url: "{{URL}}"

  # 3. AI 验证登录成功
  - AI验证登录:
      关键字: ai_assert_response
      assertion: "登录应该成功，响应中应该包含token字段"

  # 4. AI 提取Token用于后续请求
  - AI提取Token:
      关键字: ai_extract_data
      extraction: "提取响应中的token值"
      variable_name: msg_token

  # 5. AI 发送加入购物车请求
  - AI加入购物车:
      关键字: ai_send_request
      task: "将商品加入购物车，商品ID为2，选择套餐二、银色、64G规格，数量为2"
      base_url: "{{URL}}"

  # 6. AI 验证加入购物车成功
  - AI验证购物车:
      关键字: ai_assert_response
      assertion: "加入购物车应该成功，响应msg应该表示操作成功"

  # 7. AI 提取成功消息
  - AI提取成功消息:
      关键字: ai_extract_data
      extraction: "提取响应中的msg消息"
      variable_name: msg_success

  # 8. AI 分析整体流程
  - AI分析接口关联:
      关键字: ai_analyze_response
      focus: "接口关联的数据传递和业务流程完整性"

post_script:
  - 'print("AI版接口关联测试完成...")'
