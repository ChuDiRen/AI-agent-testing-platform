# AI-agent-backend 初始化数据说明

## 概述

本文档详细说明了AI-agent-backend系统的初始化数据，包括用户、角色、部门、菜单等基础数据。

## 初始化脚本

### 主要脚本
- `scripts/init_db.py` - 数据库初始化脚本，创建基础数据
- `scripts/seed_data.py` - 种子数据脚本，创建演示数据
- `scripts/run_migrations.py` - 数据库迁移脚本

### 使用方法
```bash
# 初始化数据库和基础数据
python scripts/init_db.py

# 重置数据库
python scripts/init_db.py --reset

# 创建演示数据
python scripts/seed_data.py --create

# 清除演示数据
python scripts/seed_data.py --clear
```

## 基础数据

### 部门结构
```
技术部 (ID: 1)
├── 开发组 (ID: 4)
├── 测试组 (ID: 5)
└── 运维组 (ID: 6)

人事部 (ID: 2)

财务部 (ID: 3)
```

### 角色体系
| 角色名称 | 描述 | 权限级别 |
|---------|------|---------|
| 管理员 | 系统管理员，拥有所有权限 | 最高 |
| 部门经理 | 部门经理，管理本部门用户 | 高 |
| 开发人员 | 开发人员，有开发相关权限 | 中 |
| 普通用户 | 普通用户，只有基本查看权限 | 低 |

### 基础用户账号

#### 管理员账号
| 用户名 | 密码 | 邮箱 | 部门 | 角色 | 描述 |
|--------|------|------|------|------|------|
| admin | 123456 | admin@example.com | 技术部 | 管理员 | 系统管理员 |

#### 管理层账号
| 用户名 | 密码 | 邮箱 | 部门 | 角色 | 描述 |
|--------|------|------|------|------|------|
| tech_manager | 123456 | tech.manager@example.com | 技术部 | 部门经理 | 技术部经理 |

#### 开发人员账号
| 用户名 | 密码 | 邮箱 | 部门 | 角色 | 描述 |
|--------|------|------|------|------|------|
| developer1 | 123456 | dev1@example.com | 开发组 | 开发人员 | 前端开发工程师 |
| developer2 | 123456 | dev2@example.com | 开发组 | 开发人员 | 后端开发工程师 |

#### 其他人员账号
| 用户名 | 密码 | 邮箱 | 部门 | 角色 | 描述 |
|--------|------|------|------|------|------|
| tester | 123456 | tester@example.com | 测试组 | 普通用户 | 测试工程师 |
| user | 123456 | user@example.com | 人事部 | 普通用户 | 普通用户 |

## 权限分配

### 管理员权限
- ✅ 系统管理
- ✅ 用户管理（增删改查）
- ✅ 角色管理（增删改查）
- ✅ 菜单管理（增删改查）
- ✅ 部门管理（增删改查）
- ✅ 权限缓存管理
- ✅ 数据权限管理
- ✅ 审计日志查看

### 部门经理权限
- ✅ 系统管理（查看）
- ✅ 用户管理（增改查）
- ✅ 部门管理（查看）
- ✅ 用户权限查看
- ❌ 角色管理
- ❌ 菜单管理
- ❌ 系统配置

### 开发人员权限
- ✅ 系统管理（查看）
- ✅ 用户管理（查看）
- ✅ 部门管理（查看）
- ✅ 用户权限查看
- ❌ 增删改操作
- ❌ 系统配置

### 普通用户权限
- ✅ 用户管理（查看）
- ✅ 用户权限查看
- ❌ 系统管理
- ❌ 其他管理功能

## 演示数据

### 扩展部门结构（通过seed_data.py创建）
```
技术部
├── 开发组
├── 测试组
├── 运维组
├── 前端组 ⭐
├── 后端组 ⭐
├── 移动端组 ⭐
└── 架构组 ⭐

人事部
财务部
市场部 ⭐
销售部 ⭐
客服部 ⭐
```

### 扩展角色（通过seed_data.py创建）
- 组长 - 小组组长，管理组内成员
- 设计师 - UI/UX设计师
- 产品经理 - 产品经理，负责产品规划
- 销售 - 销售人员
- 客服 - 客服人员

### 扩展用户（通过seed_data.py创建）
| 用户名 | 密码 | 部门 | 角色 | 描述 |
|--------|------|------|------|------|
| frontend_lead | 123456 | 前端组 | 组长 | 前端组组长 |
| backend_lead | 123456 | 后端组 | 组长 | 后端组组长 |
| ui_designer | 123456 | 前端组 | 设计师 | UI设计师 |
| product_manager | 123456 | 市场部 | 产品经理 | 产品经理 |
| sales_manager | 123456 | 销售部 | 销售 | 销售经理 |

## 菜单权限结构

### 系统管理
- 用户管理
  - 新增用户
  - 修改用户
  - 删除用户
- 角色管理
  - 新增角色
  - 修改角色
  - 删除角色
- 菜单管理
  - 新增菜单
  - 修改菜单
  - 删除菜单
- 部门管理
  - 新增部门
  - 修改部门
  - 删除部门
- 权限管理
  - 缓存统计查看
  - 缓存刷新
  - 缓存配置
  - 用户权限查看
  - 用户菜单查看
  - 角色权限查看
  - 用户角色分配
  - 角色菜单分配
  - 数据权限创建

## 数据库表结构

### 核心表
- `t_user` - 用户表
- `t_role` - 角色表
- `t_menu` - 菜单表
- `t_department` - 部门表
- `t_user_role` - 用户角色关联表
- `t_role_menu` - 角色菜单关联表

### 扩展表
- `t_audit_log` - 审计日志表
- `t_permission_cache` - 权限缓存表
- `t_data_permission_rule` - 数据权限规则表

## 注意事项

1. **密码安全**: 所有初始密码都是 `123456`，生产环境请及时修改
2. **权限控制**: 不同角色有不同的权限，请根据实际需求调整
3. **数据清理**: 演示数据可以通过 `seed_data.py --clear` 清除
4. **扩展性**: 可以根据业务需求添加更多部门、角色和用户

## 快速开始

1. 初始化数据库：
```bash
python scripts/init_db.py
```

2. 创建演示数据（可选）：
```bash
python scripts/seed_data.py --create
```

3. 启动服务：
```bash
python main.py
```

4. 使用管理员账号登录：
   - 用户名: `admin`
   - 密码: `123456`

现在您可以开始使用完整的RBAC权限管理系统了！
