<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../common.css">
    <title>å…³é”®å­—ç®¡ç† - é™æ€åŸå‹</title>
</head>

<body class="proto-container">
    <div class="proto-header">
        <h1 class="proto-title">å…³é”®å­—ç®¡ç†</h1>
        <button class="proto-btn proto-btn-primary" onclick="window.location.href='form.html'">+ æ–°å»ºå…³é”®å­—</button>
    </div>

    <!-- Toolbar -->
    <div style="display: flex; gap: 12px; margin-bottom: 20px;">
        <input type="text" id="searchInput" class="proto-input" style="width: 300px;" placeholder="æœç´¢å…³é”®å­—/æ–¹æ³•å..."
            onkeyup="renderList()">
        <button class="proto-btn proto-btn-secondary">ğŸ” æœç´¢</button>
    </div>

    <div class="proto-card">
        <table class="proto-table">
            <thead>
                <tr>
                    <th>å…³é”®å­—åç§°</th>
                    <th>æ–¹æ³•å</th>
                    <th>æ“ä½œç±»å‹</th>
                    <th>çŠ¶æ€</th>
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody id="keywordListBody">
            </tbody>
        </table>

        <!-- Pagination -->
        <div
            style="display: flex; justify-content: flex-end; align-items: center; margin-top: 20px; gap: 12px; color: #64748b; font-size: 14px;">
            <span>å…± 50+ æ¡</span>
            <button class="proto-btn proto-btn-secondary" disabled>ä¸Šä¸€é¡µ</button>
            <span style="font-weight: 600; color: #4f46e5;">1</span>
            <button class="proto-btn proto-btn-secondary">ä¸‹ä¸€é¡µ</button>
        </div>
    </div>

    <script src="../proto-logic.js"></script>
    <script>
        // Seed Data
        ProtoStorage.initSeed('ApiKeyWord', [
            { id: 1, name: 'å‘é€è¯·æ±‚', keyword_fun_name: 'send_request', operation_type_id: 1, is_enabled: 'true' },
            { id: 2, name: 'æ–­è¨€', keyword_fun_name: 'assert_equals', operation_type_id: 2, is_enabled: 'true' }
        ]);

        // Mock Operation Types
        const opTypes = {
            1: 'ç½‘ç»œè¯·æ±‚',
            2: 'æ–­è¨€æ“ä½œ',
            3: 'æ•°æ®å¤„ç†',
            4: 'æ•°æ®åº“æ“ä½œ'
        };

        function renderList() {
            const keyword = document.getElementById('searchInput').value.toLowerCase();
            const list = ProtoService.list('ApiKeyWord').filter(item =>
                item.name.toLowerCase().includes(keyword) ||
                item.keyword_fun_name.toLowerCase().includes(keyword)
            );
            const tbody = document.getElementById('keywordListBody');

            tbody.innerHTML = list.map(item => `
                <tr>
                    <td>${item.name}</td>
                    <td style="font-family: monospace; color: #475569;">${item.keyword_fun_name}</td>
                    <td><span class="proto-badge" style="background: #e0f2fe; color: #0284c7;">${opTypes[item.operation_type_id] || 'æœªçŸ¥'}</span></td>
                    <td>${item.is_enabled === 'true' ? '<span style="color: #10b981;">â— å¯ç”¨</span>' : '<span style="color: #94a3b8;">â— ç¦ç”¨</span>'}</td>
                    <td>
                        <a href="form.html?id=${item.id}" style="color: #4f46e5; text-decoration: none;">ç¼–è¾‘</a> 
                        <span style="color: #e2e8f0;">|</span> 
                        <a href="javascript:void(0)" onclick="handleDelete(${item.id})" style="color: #ef4444; text-decoration: none;">åˆ é™¤</a>
                    </td>
                </tr>
            `).join('');
        }

        function handleDelete(id) {
            if (confirm('ç¡®å®šåˆ é™¤è¯¥å…³é”®å­—å—ï¼Ÿ')) {
                ProtoService.delete('ApiKeyWord', id);
                ProtoUI.toast('å…³é”®å­—å·²åˆ é™¤');
                renderList();
            }
        }
        renderList();
    </script>
</body>

</html>