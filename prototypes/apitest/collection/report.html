<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../common.css">
    <title>æµ‹è¯•è®¡åˆ’æ‰§è¡ŒæŠ¥å‘Š - é™æ€åŸå‹</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        .proto-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 24px 32px;
            animation: fadeIn var(--animation-normal) ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .main-content {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        /* æŠ¥å‘Šå¤´éƒ¨å¢å¼º */
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            animation: slideDown var(--animation-normal) ease-out;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .report-info {
            flex: 1;
        }

        .report-title {
            font-size: 26px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .report-title::before {
            content: 'ğŸ“‹';
            font-size: 28px;
        }

        .report-meta {
            display: flex;
            gap: 24px;
            color: #64748b;
            font-size: 14px;
            flex-wrap: wrap;
        }

        .report-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
            transition: color var(--animation-fast);
        }

        .report-meta span:hover {
            color: var(--primary-color);
        }

        .report-actions {
            display: flex;
            gap: 12px;
        }

        /* ç»Ÿè®¡å¡ç‰‡å¢å¼º */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-item {
            background: white;
            border-radius: 14px;
            padding: 22px;
            text-align: center;
            box-shadow: var(--shadow-sm);
            border-left: 4px solid transparent;
            transition: all var(--animation-normal);
            position: relative;
            overflow: hidden;
            animation: statFadeIn var(--animation-normal) ease-out backwards;
        }

        .stat-item:nth-child(1) { animation-delay: 0s; }
        .stat-item:nth-child(2) { animation-delay: 0.1s; }
        .stat-item:nth-child(3) { animation-delay: 0.2s; }
        .stat-item:nth-child(4) { animation-delay: 0.3s; }
        .stat-item:nth-child(5) { animation-delay: 0.4s; }

        @keyframes statFadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-item::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            opacity: 0.1;
            transform: translate(20px, -20px);
        }

        .stat-item.total {
            border-left-color: var(--primary-color);
        }

        .stat-item.total::after {
            background: var(--primary-color);
        }

        .stat-item.passed {
            border-left-color: var(--success-color);
        }

        .stat-item.passed::after {
            background: var(--success-color);
        }

        .stat-item.failed {
            border-left-color: var(--error-color);
        }

        .stat-item.failed::after {
            background: var(--error-color);
        }

        .stat-item.broken {
            border-left-color: var(--warning-color);
        }

        .stat-item.broken::after {
            background: var(--warning-color);
        }

        .stat-item.skipped {
            border-left-color: #64748b;
        }

        .stat-item.skipped::after {
            background: #64748b;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 6px;
            transition: transform var(--animation-fast);
        }

        .stat-item:hover .stat-value {
            transform: scale(1.1);
        }

        .stat-item.total .stat-value {
            color: var(--primary-color);
        }

        .stat-item.passed .stat-value {
            color: var(--success-color);
        }

        .stat-item.failed .stat-value {
            color: var(--error-color);
        }

        .stat-item.broken .stat-value {
            color: var(--warning-color);
        }

        .stat-item.skipped .stat-value {
            color: #64748b;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .stat-percent {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 6px;
            padding: 2px 8px;
            background: #f1f5f9;
            border-radius: 10px;
            display: inline-block;
        }

        /* å›¾è¡¨åŒºåŸŸå¢å¼º */
        .chart-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
            flex: 1;
        }

        .chart-card {
            background: white;
            border-radius: 14px;
            padding: 24px;
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-direction: column;
            transition: all var(--animation-normal);
            animation: chartFadeIn var(--animation-normal) ease-out backwards;
        }

        .chart-card:nth-child(1) { animation-delay: 0.2s; }
        .chart-card:nth-child(2) { animation-delay: 0.3s; }

        @keyframes chartFadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .chart-card:hover {
            box-shadow: var(--shadow-md);
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-title::before {
            content: '';
            width: 4px;
            height: 18px;
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            border-radius: 2px;
        }

        .chart-content {
            flex: 1;
            min-height: 300px;
        }

        /* å†å²è®°å½•åˆ—è¡¨å¢å¼º */
        .history-list {
            flex: 1;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 14px 18px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: all var(--animation-fast);
            border-radius: 8px;
            margin-bottom: 4px;
        }

        .history-item:hover {
            background: #f8fafc;
            transform: translateX(4px);
        }

        .history-item.active {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left: 3px solid var(--primary-color);
        }

        .history-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 14px;
            flex-shrink: 0;
            transition: transform var(--animation-fast);
        }

        .history-item:hover .history-status {
            transform: scale(1.3);
        }

        .history-status.success {
            background: linear-gradient(135deg, var(--success-color), #059669);
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
        }

        .history-status.fail {
            background: linear-gradient(135deg, var(--error-color), #dc2626);
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.4);
        }

        .history-info {
            flex: 1;
        }

        .history-name {
            font-weight: 500;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .history-time {
            font-size: 12px;
            color: #94a3b8;
        }

        .history-duration {
            font-size: 13px;
            color: #64748b;
            font-family: 'Monaco', 'Menlo', monospace;
        }

        /* ç”¨ä¾‹è¡¨æ ¼å¢å¼º */
        .case-table {
            width: 100%;
            border-collapse: collapse;
        }

        .case-table th,
        .case-table td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 1px solid #f1f5f9;
        }

        .case-table th {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            font-weight: 600;
            color: #64748b;
            font-size: 13px;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .case-table tbody tr {
            transition: all var(--animation-fast);
        }

        .case-table tbody tr:hover {
            background: #f8fafc;
            transform: scale(1.005);
        }

        /* çŠ¶æ€å¾½ç« å¢å¼º */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            transition: all var(--animation-fast);
        }

        .status-badge:hover {
            transform: scale(1.05);
        }

        .status-badge.passed {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            color: #166534;
        }

        .status-badge.failed {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: #991b1b;
        }

        .status-badge.broken {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #92400e;
        }

        .status-badge.skipped {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: #475569;
        }

        /* ç­›é€‰æŒ‰é’®å¢å¼º */
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            color: #64748b;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all var(--animation-fast);
        }

        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            border-color: var(--primary-color);
            color: white;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .filter-btn .count {
            margin-left: 6px;
            padding: 2px 8px;
            background: rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            font-size: 11px;
        }

        .filter-btn.active .count {
            background: rgba(255, 255, 255, 0.25);
        }

        /* ä¾§è¾¹é¢æ¿å¢å¼º */
        .case-detail-panel {
            position: fixed;
            top: 0;
            right: -520px;
            width: 520px;
            height: 100vh;
            background: white;
            box-shadow: -8px 0 30px rgba(0, 0, 0, 0.15);
            transition: right var(--animation-normal) cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .case-detail-panel.open {
            right: 0;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 22px;
            border-bottom: 1px solid #e2e8f0;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .panel-title {
            font-size: 17px;
            font-weight: 600;
            color: #1e293b;
        }

        .panel-close {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            color: #64748b;
            transition: all var(--animation-fast);
            font-size: 18px;
        }

        .panel-close:hover {
            background: #fee2e2;
            color: var(--error-color);
            transform: rotate(90deg);
        }

        .panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 22px;
        }

        .detail-section {
            margin-bottom: 26px;
        }

        .detail-section-title {
            font-size: 13px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-section-title::before {
            content: '';
            width: 3px;
            height: 14px;
            background: var(--primary-color);
            border-radius: 2px;
        }

        .detail-item {
            display: flex;
            margin-bottom: 10px;
        }

        .detail-label {
            width: 90px;
            color: #94a3b8;
            font-size: 13px;
        }

        .detail-value {
            flex: 1;
            color: #1e293b;
            font-size: 13px;
        }

        /* æ­¥éª¤åˆ—è¡¨å¢å¼º */
        .step-list {
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
        }

        .step-item {
            display: flex;
            align-items: flex-start;
            padding: 14px 18px;
            border-bottom: 1px solid #f1f5f9;
            transition: all var(--animation-fast);
        }

        .step-item:hover {
            background: #f8fafc;
        }

        .step-item:last-child {
            border-bottom: none;
        }

        .step-number {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            margin-right: 14px;
            flex-shrink: 0;
            transition: all var(--animation-fast);
        }

        .step-item:hover .step-number {
            transform: scale(1.1);
        }

        .step-item.passed .step-number {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            color: #166534;
            box-shadow: 0 2px 6px rgba(16, 185, 129, 0.2);
        }

        .step-item.failed .step-number {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            color: #991b1b;
            box-shadow: 0 2px 6px rgba(239, 68, 68, 0.2);
        }

        .step-content {
            flex: 1;
        }

        .step-name {
            font-weight: 500;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .step-desc {
            font-size: 12px;
            color: #64748b;
        }

        /* é”™è¯¯å—å¢å¼º */
        .error-block {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fecaca;
            border-radius: 10px;
            padding: 18px;
            margin-top: 14px;
        }

        .error-title {
            color: var(--error-color);
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .error-title::before {
            content: 'âš ï¸';
        }

        .error-message {
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
            font-size: 12px;
            color: #991b1b;
            white-space: pre-wrap;
            word-break: break-all;
            background: rgba(255, 255, 255, 0.5);
            padding: 12px;
            border-radius: 6px;
        }

        .allure-frame {
            width: 100%;
            height: 600px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        /* Tabå¯¼èˆªå¢å¼º */
        .tab-nav {
            display: flex;
            gap: 0;
            border-bottom: 2px solid #f1f5f9;
            margin-bottom: 22px;
        }

        .tab-nav-item {
            padding: 14px 22px;
            cursor: pointer;
            color: #64748b;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all var(--animation-fast);
            font-weight: 500;
            position: relative;
        }

        .tab-nav-item:hover {
            color: var(--primary-color);
            background: var(--primary-light);
        }

        .tab-nav-item.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
        }

        .tab-nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
            animation: tabIndicator var(--animation-normal) ease-out;
        }

        @keyframes tabIndicator {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }

        /* é®ç½©å±‚å¢å¼º */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            z-index: 99;
            display: none;
            opacity: 0;
            transition: opacity var(--animation-normal);
        }

        .overlay.open {
            display: block;
            opacity: 1;
        }

        /* å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 1200px) {
            .stat-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .proto-container {
                padding: 16px 20px;
            }

            .chart-row {
                grid-template-columns: 1fr;
            }

            .stat-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .report-header {
                flex-direction: column;
                gap: 16px;
            }

            .report-actions {
                width: 100%;
                flex-wrap: wrap;
            }

            .stat-grid {
                grid-template-columns: 1fr;
            }

            .case-detail-panel {
                width: 100%;
                right: -100%;
            }

            .tab-nav {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .tab-nav-item {
                white-space: nowrap;
                padding: 12px 16px;
            }
        }
    </style>
</head>

<body class="proto-container">
    <!-- æŠ¥å‘Šå¤´éƒ¨ -->
    <div class="report-header">
        <div class="report-info">
            <h1 class="report-title" id="reportTitle">ç”µå•†æ ¸å¿ƒæµç¨‹å›å½’æµ‹è¯•</h1>
            <div class="report-meta">
                <span>ğŸ“ ç”µå•†å¹³å°API</span>
                <span>ğŸ• æ‰§è¡Œæ—¶é—´: 2025-12-29 15:30:00</span>
                <span>â±ï¸ æ€»è€—æ—¶: 5m 48s</span>
                <span>ğŸ‘¤ æ‰§è¡Œäºº: admin</span>
            </div>
        </div>
        <div class="report-actions">
            <button class="proto-btn proto-btn-secondary" onclick="window.location.href='index.html'">è¿”å›åˆ—è¡¨</button>
            <button class="proto-btn proto-btn-secondary" onclick="exportReport()">ğŸ“¥ å¯¼å‡ºæŠ¥å‘Š</button>
            <button class="proto-btn proto-btn-primary" onclick="rerunTest()">ğŸ”„ é‡æ–°æ‰§è¡Œ</button>
        </div>
    </div>

    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <div class="stat-grid">
        <div class="stat-item total">
            <div class="stat-value">158</div>
            <div class="stat-label">æ€»ç”¨ä¾‹æ•°</div>
        </div>
        <div class="stat-item passed">
            <div class="stat-value">145</div>
            <div class="stat-label">é€šè¿‡</div>
            <div class="stat-percent">91.8%</div>
        </div>
        <div class="stat-item failed">
            <div class="stat-value">8</div>
            <div class="stat-label">å¤±è´¥</div>
            <div class="stat-percent">5.1%</div>
        </div>
        <div class="stat-item broken">
            <div class="stat-value">3</div>
            <div class="stat-label">å¼‚å¸¸</div>
            <div class="stat-percent">1.9%</div>
        </div>
        <div class="stat-item skipped">
            <div class="stat-value">2</div>
            <div class="stat-label">è·³è¿‡</div>
            <div class="stat-percent">1.3%</div>
        </div>
    </div>

    <!-- Tabå¯¼èˆª -->
    <div class="tab-nav">
        <div class="tab-nav-item active" onclick="switchMainTab('overview')">ğŸ“Š æ‰§è¡Œæ¦‚è§ˆ</div>
        <div class="tab-nav-item" onclick="switchMainTab('cases')">ğŸ“‹ ç”¨ä¾‹è¯¦æƒ…</div>
        <div class="tab-nav-item" onclick="switchMainTab('history')">ğŸ“ˆ å†å²è¶‹åŠ¿</div>
        <div class="tab-nav-item" onclick="switchMainTab('allure')">ğŸ“‘ AllureæŠ¥å‘Š</div>
    </div>

    <!-- æ‰§è¡Œæ¦‚è§ˆ Tab -->
    <div id="tab-overview" class="main-tab-content">
        <div class="chart-row">
            <div class="chart-card">
                <div class="chart-title">æ‰§è¡Œç»“æœåˆ†å¸ƒ</div>
                <div id="pieChart" class="chart-content"></div>
            </div>
            <div class="chart-card">
                <div class="chart-title">æ‰§è¡Œè€—æ—¶åˆ†å¸ƒ (Top 10)</div>
                <div id="durationChart" class="chart-content"></div>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-title">å¤±è´¥ç”¨ä¾‹ Top 5</div>
            <table class="case-table">
                <thead>
                    <tr>
                        <th>ç”¨ä¾‹åç§°</th>
                        <th>å¤±è´¥åŸå› </th>
                        <th>å¤±è´¥æ¬¡æ•°</th>
                        <th>æœ€åå¤±è´¥æ—¶é—´</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ç”¨æˆ·ç™»å½• - å¯†ç é”™è¯¯åœºæ™¯</td>
                        <td><span style="color: #ef4444;">æ–­è¨€å¤±è´¥: é¢„æœŸè¿”å›401ï¼Œå®é™…è¿”å›200</span></td>
                        <td><span style="color: #ef4444; font-weight: bold;">12</span></td>
                        <td>2025-12-29 15:32:11</td>
                        <td><a href="#" onclick="openCaseDetail(1)" style="color: #3b82f6;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                    <tr>
                        <td>è®¢å•åˆ›å»º - åº“å­˜ä¸è¶³</td>
                        <td><span style="color: #ef4444;">æ¥å£è¶…æ—¶: å“åº”æ—¶é—´è¶…è¿‡30s</span></td>
                        <td><span style="color: #ef4444; font-weight: bold;">8</span></td>
                        <td>2025-12-29 15:28:45</td>
                        <td><a href="#" onclick="openCaseDetail(2)" style="color: #3b82f6;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                    <tr>
                        <td>æ”¯ä»˜å›è°ƒ - ç­¾åéªŒè¯</td>
                        <td><span style="color: #ef4444;">ç­¾åæ ¡éªŒå¤±è´¥</span></td>
                        <td><span style="color: #ef4444; font-weight: bold;">5</span></td>
                        <td>2025-12-29 15:25:30</td>
                        <td><a href="#" onclick="openCaseDetail(3)" style="color: #3b82f6;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                    <tr>
                        <td>å•†å“æœç´¢ - ç‰¹æ®Šå­—ç¬¦</td>
                        <td><span style="color: #f59e0b;">æ•°æ®åº“è¿æ¥å¼‚å¸¸</span></td>
                        <td><span style="color: #f59e0b; font-weight: bold;">3</span></td>
                        <td>2025-12-29 15:20:18</td>
                        <td><a href="#" onclick="openCaseDetail(4)" style="color: #3b82f6;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                    <tr>
                        <td>ä¼˜æƒ åˆ¸æ ¸é”€ - å¹¶å‘åœºæ™¯</td>
                        <td><span style="color: #ef4444;">æ•°æ®ä¸ä¸€è‡´: ä¼˜æƒ åˆ¸çŠ¶æ€æœªæ›´æ–°</span></td>
                        <td><span style="color: #ef4444; font-weight: bold;">2</span></td>
                        <td>2025-12-29 15:18:05</td>
                        <td><a href="#" onclick="openCaseDetail(5)" style="color: #3b82f6;">æŸ¥çœ‹è¯¦æƒ…</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ç”¨ä¾‹è¯¦æƒ… Tab -->
    <div id="tab-cases" class="main-tab-content" style="display: none;">
        <div class="chart-card">
            <div class="filter-bar">
                <button class="filter-btn active" onclick="filterCases('all')">å…¨éƒ¨ <span class="count">158</span></button>
                <button class="filter-btn" onclick="filterCases('passed')">é€šè¿‡ <span class="count">145</span></button>
                <button class="filter-btn" onclick="filterCases('failed')">å¤±è´¥ <span class="count">8</span></button>
                <button class="filter-btn" onclick="filterCases('broken')">å¼‚å¸¸ <span class="count">3</span></button>
                <button class="filter-btn" onclick="filterCases('skipped')">è·³è¿‡ <span class="count">2</span></button>
                <input type="text" class="proto-input" placeholder="æœç´¢ç”¨ä¾‹åç§°..." style="margin-left: auto; width: 250px;">
            </div>

            <div style="max-height: 500px; overflow-y: auto;">
                <table class="case-table">
                    <thead>
                        <tr>
                            <th style="width: 40px;">#</th>
                            <th>ç”¨ä¾‹åç§°</th>
                            <th style="width: 100px;">çŠ¶æ€</th>
                            <th style="width: 100px;">è€—æ—¶</th>
                            <th style="width: 80px;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="caseTableBody">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- å†å²è¶‹åŠ¿ Tab -->
    <div id="tab-history" class="main-tab-content" style="display: none;">
        <div class="chart-row">
            <div class="chart-card">
                <div class="chart-title">æ‰§è¡Œç»“æœè¶‹åŠ¿ (è¿‘5æ¬¡)</div>
                <div id="barChart" class="chart-content"></div>
            </div>
            <div class="chart-card">
                <div class="chart-title">æ‰§è¡Œè€—æ—¶è¶‹åŠ¿ (è¿‘10æ¬¡)</div>
                <div id="lineChart" class="chart-content"></div>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-title">å†å²æ‰§è¡Œè®°å½•</div>
            <div class="history-list">
                <div class="history-item active">
                    <div class="history-status success"></div>
                    <div class="history-info">
                        <div class="history-name">Run #24 - 91.8% é€šè¿‡</div>
                        <div class="history-time">2025-12-29 15:30:00</div>
                    </div>
                    <div class="history-duration">5m 48s</div>
                </div>
                <div class="history-item">
                    <div class="history-status success"></div>
                    <div class="history-info">
                        <div class="history-name">Run #23 - 94.2% é€šè¿‡</div>
                        <div class="history-time">2025-12-28 10:15:00</div>
                    </div>
                    <div class="history-duration">5m 12s</div>
                </div>
                <div class="history-item">
                    <div class="history-status fail"></div>
                    <div class="history-info">
                        <div class="history-name">Run #22 - 85.3% é€šè¿‡</div>
                        <div class="history-time">2025-12-27 16:45:00</div>
                    </div>
                    <div class="history-duration">6m 34s</div>
                </div>
                <div class="history-item">
                    <div class="history-status success"></div>
                    <div class="history-info">
                        <div class="history-name">Run #21 - 92.1% é€šè¿‡</div>
                        <div class="history-time">2025-12-26 09:30:00</div>
                    </div>
                    <div class="history-duration">5m 28s</div>
                </div>
                <div class="history-item">
                    <div class="history-status success"></div>
                    <div class="history-info">
                        <div class="history-name">Run #20 - 95.5% é€šè¿‡</div>
                        <div class="history-time">2025-12-25 14:20:00</div>
                    </div>
                    <div class="history-duration">4m 56s</div>
                </div>
            </div>
        </div>
    </div>

    <!-- AllureæŠ¥å‘Š Tab -->
    <div id="tab-allure" class="main-tab-content" style="display: none;">
        <div class="chart-card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <div class="chart-title" style="margin-bottom: 0;">Allure æµ‹è¯•æŠ¥å‘Š</div>
                <button class="proto-btn proto-btn-secondary" onclick="openAllureInNewTab()">ğŸ”— æ–°çª—å£æ‰“å¼€</button>
            </div>
            <div style="background: #f8fafc; border-radius: 8px; padding: 40px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“Š</div>
                <p style="color: #64748b; margin-bottom: 16px;">AllureæŠ¥å‘Šå°†åœ¨æ­¤å¤„åµŒå…¥å±•ç¤º</p>
                <p style="font-size: 13px; color: #94a3b8;">æŠ¥å‘Šè·¯å¾„: /reports/allure/2025-12-29-153000/index.html</p>
                <div style="margin-top: 24px;">
                    <button class="proto-btn proto-btn-primary" onclick="loadAllureReport()">åŠ è½½æŠ¥å‘Š</button>
                </div>
            </div>
            <iframe id="allureFrame" class="allure-frame" style="display: none;" src=""></iframe>
        </div>
    </div>

    <!-- ç”¨ä¾‹è¯¦æƒ…ä¾§è¾¹é¢æ¿ -->
    <div class="overlay" id="overlay" onclick="closeCaseDetail()"></div>
    <div class="case-detail-panel" id="caseDetailPanel">
        <div class="panel-header">
            <div class="panel-title" id="panelTitle">ç”¨ä¾‹è¯¦æƒ…</div>
            <div class="panel-close" onclick="closeCaseDetail()">âœ•</div>
        </div>
        <div class="panel-body">
            <div class="detail-section">
                <div class="detail-section-title">åŸºæœ¬ä¿¡æ¯</div>
                <div class="detail-item">
                    <span class="detail-label">ç”¨ä¾‹åç§°</span>
                    <span class="detail-value" id="detailName">ç”¨æˆ·ç™»å½• - å¯†ç é”™è¯¯åœºæ™¯</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">æ‰§è¡ŒçŠ¶æ€</span>
                    <span class="detail-value"><span class="status-badge failed" id="detailStatus">å¤±è´¥</span></span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">æ‰§è¡Œè€—æ—¶</span>
                    <span class="detail-value" id="detailDuration">1.23s</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">å¼€å§‹æ—¶é—´</span>
                    <span class="detail-value" id="detailStartTime">2025-12-29 15:32:10</span>
                </div>
            </div>

            <div class="detail-section">
                <div class="detail-section-title">æ‰§è¡Œæ­¥éª¤</div>
                <div class="step-list" id="stepList">
                    <div class="step-item passed">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-name">å‘é€ç™»å½•è¯·æ±‚</div>
                            <div class="step-desc">POST /api/v1/login</div>
                        </div>
                    </div>
                    <div class="step-item passed">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-name">è·å–å“åº”æ•°æ®</div>
                            <div class="step-desc">å“åº”çŠ¶æ€ç : 200</div>
                        </div>
                    </div>
                    <div class="step-item failed">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-name">æ–­è¨€éªŒè¯</div>
                            <div class="step-desc">éªŒè¯å“åº”çŠ¶æ€ç </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="detail-section" id="errorSection">
                <div class="detail-section-title">é”™è¯¯ä¿¡æ¯</div>
                <div class="error-block">
                    <div class="error-title">AssertionError</div>
                    <div class="error-message" id="errorMessage">æ–­è¨€å¤±è´¥: é¢„æœŸè¿”å›401ï¼Œå®é™…è¿”å›200

Expected: status_code == 401
Actual: status_code == 200

at test_login_wrong_password (test_login.py:45)
at pytest_runtest_call (runner.py:162)</div>
                </div>
            </div>

            <div class="detail-section">
                <div class="detail-section-title">è¯·æ±‚/å“åº”</div>
                <div style="background: #1e293b; border-radius: 8px; padding: 16px; font-family: monospace; font-size: 12px; color: #e2e8f0; max-height: 200px; overflow: auto;">
                    <div style="color: #7dd3fc; margin-bottom: 8px;">// Request</div>
                    <div>POST /api/v1/login</div>
                    <div>Content-Type: application/json</div>
                    <div style="margin-top: 8px;">{"username": "admin", "password": "wrong_pwd"}</div>
                    <div style="color: #7dd3fc; margin-top: 16px; margin-bottom: 8px;">// Response</div>
                    <div>Status: 200 OK</div>
                    <div style="margin-top: 8px;">{"code": 200, "msg": "ç™»å½•æˆåŠŸ", "data": {...}}</div>
                </div>
            </div>
        </div>
    </div>

    <script src="../proto-logic.js"></script>
    <script>
        // è·å–URLå‚æ•°
        const id = getUrlParam('id');
        if (!id) {
            ProtoUI.toast('æœªæŒ‡å®šè®¡åˆ’ID', 'error');
        }

        // ä¸»Tabåˆ‡æ¢
        function switchMainTab(name) {
            document.querySelectorAll('.main-tab-content').forEach(c => c.style.display = 'none');
            document.querySelectorAll('.tab-nav-item').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + name).style.display = 'block';
            event.currentTarget.classList.add('active');

            // å»¶è¿Ÿåˆå§‹åŒ–å›¾è¡¨
            if (name === 'overview') {
                setTimeout(initOverviewCharts, 100);
            } else if (name === 'history') {
                setTimeout(initHistoryCharts, 100);
            }
        }

        // ç­›é€‰ç”¨ä¾‹
        function filterCases(status) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.currentTarget.classList.add('active');
            // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè¿‡æ»¤è¡¨æ ¼æ•°æ®
            ProtoUI.toast(`ç­›é€‰: ${status}`, 'success');
        }

        // æ‰“å¼€ç”¨ä¾‹è¯¦æƒ…
        function openCaseDetail(caseId) {
            document.getElementById('overlay').classList.add('open');
            document.getElementById('caseDetailPanel').classList.add('open');
        }

        // å…³é—­ç”¨ä¾‹è¯¦æƒ…
        function closeCaseDetail() {
            document.getElementById('overlay').classList.remove('open');
            document.getElementById('caseDetailPanel').classList.remove('open');
        }

        // å¯¼å‡ºæŠ¥å‘Š
        function exportReport() {
            ProtoUI.toast('æ­£åœ¨ç”ŸæˆæŠ¥å‘Š...', 'success');
            setTimeout(() => {
                ProtoUI.toast('æŠ¥å‘Šå·²ç”Ÿæˆï¼Œå¼€å§‹ä¸‹è½½', 'success');
            }, 1500);
        }

        // é‡æ–°æ‰§è¡Œ
        function rerunTest() {
            if (confirm('ç¡®å®šè¦é‡æ–°æ‰§è¡Œæ­¤æµ‹è¯•è®¡åˆ’å—ï¼Ÿ')) {
                ProtoUI.toast('æµ‹è¯•ä»»åŠ¡å·²æäº¤ï¼Œè¯·ç¨åæŸ¥çœ‹ç»“æœ', 'success');
            }
        }

        // åŠ è½½AllureæŠ¥å‘Š
        function loadAllureReport() {
            const placeholder = event.currentTarget.parentElement.parentElement;
            const frame = document.getElementById('allureFrame');
            placeholder.style.display = 'none';
            frame.style.display = 'block';
            frame.src = 'about:blank'; // å®é™…é¡¹ç›®ä¸­è¿™é‡Œæ˜¯çœŸå®çš„AllureæŠ¥å‘ŠURL
            ProtoUI.toast('AllureæŠ¥å‘ŠåŠ è½½ä¸­...', 'success');
        }

        // æ–°çª—å£æ‰“å¼€Allure
        function openAllureInNewTab() {
            window.open('about:blank', '_blank');
            ProtoUI.toast('å·²åœ¨æ–°çª—å£æ‰“å¼€', 'success');
        }

        // ç”Ÿæˆç”¨ä¾‹è¡¨æ ¼æ•°æ®
        function generateCaseTable() {
            const tbody = document.getElementById('caseTableBody');
            const statuses = ['passed', 'passed', 'passed', 'passed', 'passed', 'passed', 'passed', 'passed', 'failed', 'broken', 'skipped'];
            const cases = [
                'ç”¨æˆ·ç™»å½• - æ­£å¸¸åœºæ™¯',
                'ç”¨æˆ·ç™»å½• - å¯†ç é”™è¯¯åœºæ™¯',
                'ç”¨æˆ·æ³¨å†Œ - æ­£å¸¸æµç¨‹',
                'å•†å“åˆ—è¡¨ - åˆ†é¡µæŸ¥è¯¢',
                'å•†å“è¯¦æƒ… - æ­£å¸¸è·å–',
                'è´­ç‰©è½¦ - æ·»åŠ å•†å“',
                'è´­ç‰©è½¦ - åˆ é™¤å•†å“',
                'è®¢å•åˆ›å»º - æ­£å¸¸æµç¨‹',
                'è®¢å•åˆ›å»º - åº“å­˜ä¸è¶³',
                'æ”¯ä»˜å›è°ƒ - ç­¾åéªŒè¯',
                'ä¼˜æƒ åˆ¸æ ¸é”€ - å·²è¿‡æœŸ'
            ];

            let html = '';
            cases.forEach((name, i) => {
                const status = statuses[i];
                const statusText = { passed: 'é€šè¿‡', failed: 'å¤±è´¥', broken: 'å¼‚å¸¸', skipped: 'è·³è¿‡' }[status];
                const duration = (Math.random() * 3 + 0.1).toFixed(2) + 's';
                html += `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${name}</td>
                        <td><span class="status-badge ${status}">${statusText}</span></td>
                        <td>${duration}</td>
                        <td><a href="#" onclick="openCaseDetail(${i + 1})" style="color: #3b82f6;">è¯¦æƒ…</a></td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }

        // åˆå§‹åŒ–æ¦‚è§ˆå›¾è¡¨
        function initOverviewCharts() {
            // é¥¼å›¾
            const pieChart = echarts.init(document.getElementById('pieChart'));
            pieChart.setOption({
                tooltip: { trigger: 'item', formatter: '{b}: {c} ({d}%)' },
                series: [{
                    type: 'pie',
                    radius: ['45%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: { borderRadius: 10, borderColor: '#fff', borderWidth: 2 },
                    label: { show: true, formatter: '{b}\n{c}' },
                    data: [
                        { value: 145, name: 'é€šè¿‡', itemStyle: { color: '#10b981' } },
                        { value: 8, name: 'å¤±è´¥', itemStyle: { color: '#ef4444' } },
                        { value: 3, name: 'å¼‚å¸¸', itemStyle: { color: '#f59e0b' } },
                        { value: 2, name: 'è·³è¿‡', itemStyle: { color: '#94a3b8' } }
                    ]
                }]
            });

            // è€—æ—¶åˆ†å¸ƒ
            const durationChart = echarts.init(document.getElementById('durationChart'));
            durationChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: { type: 'value', name: 'ç§’' },
                yAxis: {
                    type: 'category',
                    data: ['è®¢å•åˆ›å»º-åº“å­˜ä¸è¶³', 'æ”¯ä»˜å›è°ƒ-ç­¾åéªŒè¯', 'å•†å“æœç´¢-ç‰¹æ®Šå­—ç¬¦', 'ç”¨æˆ·ç™»å½•-å¯†ç é”™è¯¯', 'è´­ç‰©è½¦-æ·»åŠ å•†å“',
                        'è®¢å•è¯¦æƒ…-æŸ¥è¯¢', 'ç”¨æˆ·æ³¨å†Œ-æ­£å¸¸', 'å•†å“åˆ—è¡¨-åˆ†é¡µ', 'ä¼˜æƒ åˆ¸-æ ¸é”€', 'è´­ç‰©è½¦-åˆ é™¤']
                },
                series: [{
                    type: 'bar',
                    data: [3.2, 2.8, 2.5, 2.1, 1.8, 1.5, 1.2, 0.9, 0.7, 0.5],
                    itemStyle: {
                        color: function (params) {
                            const colors = ['#ef4444', '#ef4444', '#f59e0b', '#ef4444', '#10b981',
                                '#10b981', '#10b981', '#10b981', '#10b981', '#10b981'];
                            return colors[params.dataIndex];
                        }
                    }
                }]
            });

            window.addEventListener('resize', () => {
                pieChart.resize();
                durationChart.resize();
            });
        }

        // åˆå§‹åŒ–å†å²å›¾è¡¨
        function initHistoryCharts() {
            // æŸ±çŠ¶å›¾
            const barChart = echarts.init(document.getElementById('barChart'));
            barChart.setOption({
                tooltip: { trigger: 'axis' },
                legend: { data: ['é€šè¿‡', 'å¤±è´¥', 'å¼‚å¸¸', 'è·³è¿‡'], bottom: 0 },
                grid: { left: '3%', right: '4%', bottom: '15%', containLabel: true },
                xAxis: { data: ['Run #20', 'Run #21', 'Run #22', 'Run #23', 'Run #24'] },
                yAxis: { type: 'value' },
                series: [
                    { name: 'é€šè¿‡', type: 'bar', stack: 'total', data: [150, 145, 134, 148, 145], itemStyle: { color: '#10b981' } },
                    { name: 'å¤±è´¥', type: 'bar', stack: 'total', data: [5, 8, 18, 6, 8], itemStyle: { color: '#ef4444' } },
                    { name: 'å¼‚å¸¸', type: 'bar', stack: 'total', data: [2, 3, 4, 2, 3], itemStyle: { color: '#f59e0b' } },
                    { name: 'è·³è¿‡', type: 'bar', stack: 'total', data: [1, 2, 2, 2, 2], itemStyle: { color: '#94a3b8' } }
                ]
            });

            // æŠ˜çº¿å›¾
            const lineChart = echarts.init(document.getElementById('lineChart'));
            lineChart.setOption({
                tooltip: { trigger: 'axis' },
                grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                xAxis: { type: 'category', data: ['#15', '#16', '#17', '#18', '#19', '#20', '#21', '#22', '#23', '#24'] },
                yAxis: { type: 'value', name: 'ç§’' },
                series: [{
                    data: [280, 295, 310, 298, 285, 296, 328, 394, 312, 348],
                    type: 'line',
                    smooth: true,
                    areaStyle: { color: 'rgba(59, 130, 246, 0.1)' },
                    itemStyle: { color: '#3b82f6' }
                }]
            });

            window.addEventListener('resize', () => {
                barChart.resize();
                lineChart.resize();
            });
        }

        // åˆå§‹åŒ–
        generateCaseTable();
        setTimeout(initOverviewCharts, 100);
    </script>
</body>

</html>
